# Таб «Ивенты» 🎾

## Описание
Ключевой модуль приложения. Здесь пользователь находит игры, создаёт запросы на партнёра, записывается на турниры, и вносит результаты. Организован тремя внутренними табами.

## Структура экрана

```
┌─────────────────────────────────────────┐
│  Ивенты                    💬    🔔     │
├─────────────────────────────────────────┤
│  ┌──────────┐┌──────────┐┌──────────┐  │
│  │  Лента   ││ Календарь││   Мои    │  │
│  └──────────┘└──────────┘└──────────┘  │
│                                         │
│  [Содержимое выбранного таба]          │
│                                         │
│                                 ┌─────┐ │
│                                 │  +  │ │ ← FAB
│                                 └─────┘ │
├─────────────────────────────────────────┤
│ 🏠  👥  🎾  🏛  👤                     │
└─────────────────────────────────────────┘
```

---

## Внутренний таб 1: Лента

Единый поток всех доступных ивентов. По умолчанию отображается при открытии таба.

### Фильтры (горизонтальный scroll chips)
| Фильтр | Значения |
|--------|----------|
| Тип ивента | Ищу партнёра / Организованная игра / Турнир / Тренировка |
| Статус | Набор открыт / Скоро набор / Завершён |
| Формат | Singles / Doubles / Mixed / Team |
| Уровень | Начинающий / Любитель / Продвинутый / Профи |
| Дата | Сегодня / Эта неделя / Этот месяц / Выбрать даты |
| Район | Список районов Астаны |
| Стоимость | Бесплатно / Платные / Все |
| Сообщество | Мои сообщества / Все |

### Статусы карточек (цветовые метки)
- 🟢 **Набор открыт** — можно записаться прямо сейчас
- 🟡 **Скоро набор** — дата старта регистрации в будущем
- 🔵 **Ищу партнёра** — индивидуальный запрос от игрока
- ⚪ **Завершён** — результаты доступны
- 🔴 **Набор закрыт** — все места заняты, можно встать в лист ожидания

### Карточка ивента в ленте
```
┌─────────────────────────────────────────┐
│ 🟢 Набор открыт          Singles       │
│                                         │
│ 🎾 Ищу партнёра для Singles             │
│                                         │
│ 👤 Айдар С. (3.5)                      │
│ 📍 Tennis Club Astana, корт 3          │
│ 📅 Завтра, 18:00 – 19:30              │
│ 💰 Бесплатно                           │
│ 👥 1/2 участников                      │
│ 📊 Уровень: 3.0 – 4.0                 │
│                                         │
│  ┌────────────────────────────────┐     │
│  │         Записаться            │     │
│  └────────────────────────────────┘     │
└─────────────────────────────────────────┘
```

### Карточка турнира
```
┌─────────────────────────────────────────┐
│ 🟢 Набор открыт      Round-Robin       │
│                                         │
│ 🏆 Весенний турнир NTC                  │
│                                         │
│ 🏛 NTC Astana League ✓                 │
│ 📍 NTC Astana, корты 1-4              │
│ 📅 15 марта, 10:00 – 18:00            │
│ 💰 5,000 ₸                             │
│ 👥 12/16 участников                    │
│ 📊 Уровень: 3.5+                      │
│ 🎯 Формат: Round-Robin → Knock-out    │
│                                         │
│  ┌────────────────────────────────┐     │
│  │      Записаться (5,000 ₸)     │     │
│  └────────────────────────────────┘     │
└─────────────────────────────────────────┘
```

---

## Внутренний таб 2: Календарь

### Месячный вид
- Сетка месяца
- Точки на датах с ивентами (цвет = статус)
- Свайп влево/вправо для смены месяца
- Нажатие на дату → показ списка ивентов внизу

### Дневной вид (при выборе даты)
- Таймлайн с ивентами по времени
- Показывает: мои записи + ивенты из моих сообществ
- Каждый слот кликабельный → детальный экран ивента

---

## Внутренний таб 3: Мои

### Три секции (вертикальный scroll)

**1. Мои запросы** (созданные мной)
- Активные запросы с количеством откликов
- Статус: ожидает / подтверждён / отменён / завершён
- Свайп влево → редактировать / удалить

**2. Записался** (чужие ивенты)
- Ивенты на которые я записался
- Статус: подтверждён / в листе ожидания
- Свайп влево → отменить запись

**3. Прошедшие** (завершённые)
- Завершённые ивенты с результатами
- Внести результат (если не внесён)
- Подтвердить счёт (если ожидает подтверждения)

---

## FAB: Создание ивента (Конструктор)

Многошаговый wizard. Каждый шаг — отдельный экран. Прогресс-бар сверху. Кнопка «Назад» на каждом шаге.

### Шаг 1: Тип ивента
```
Что вы хотите организовать?

┌──────────────────────────────────┐
│ 🔍 Ищу партнёра                  │
│    Найти одного соперника        │
└──────────────────────────────────┘
┌──────────────────────────────────┐
│ 🎾 Организую игру                │
│    Собрать группу для игры       │
└──────────────────────────────────┘
┌──────────────────────────────────┐
│ 🏆 Турнир                        │
│    Организовать турнир с сеткой  │
└──────────────────────────────────┘
┌──────────────────────────────────┐
│ 🏋️ Тренировка / отработка       │
│    Совместная тренировка         │
└──────────────────────────────────┘
```

### Шаг 2: Состав игроков
```
Формат по составу:

○ Singles (1 на 1)
○ Doubles (2 на 2)
○ Mixed Doubles (муж + жен vs муж + жен)
○ Team (3+ игроков, команды)
○ Другой (указать в описании)
```

### Шаг 3: Формат матча (конструктор)
```
Настройте правила матча:

Формат сета:
○ Стандартный (до 6 гейм, тай-брейк при 6:6)
○ Pro-Set (до 8 геймов)
○ Short Set (до 4 геймов)
○ Timed (ограничение по времени)

Количество сетов:
○ 1 сет
○ Best of 3
○ Best of 5

Решающий сет:
○ Обычный тай-брейк (до 7)
○ Супер тай-брейк (до 10)
○ Полный сет

─ или ─

Свободный формат (описание текстом):
┌──────────────────────────────────┐
│                                  │
└──────────────────────────────────┘
```

### Шаг 4: Турнирная система (только для типа «Турнир»)
```
Система турнира:

○ Knock-out (олимпийская)
○ Round-Robin (каждый с каждым)
○ Swiss System
○ Double Elimination
○ Groups + Knock-out (групповой + плей-офф)
○ Другая (описание)

Количество участников:
[4] [8] [16] [32] [Другое: ___]

Сеяние:
○ По рейтингу (автоматическое)
○ Случайная жеребьёвка
○ Ручное (назначу сам)
```

### Шаг 5: Место и время
```
Где и когда:

Корт / площадка:
┌──────────────────────────────────┐
│ 🔍 Выберите из списка или введите│
└──────────────────────────────────┘
(Интеграция с картой кортов)

Дата:  [📅 Выбрать дату]
Начало: [🕐 18:00]
Конец:  [🕐 19:30] (опционально)

Повторяющийся ивент:
○ Нет (одноразовый)
○ Каждую неделю
○ Каждые 2 недели
○ Каждый месяц
```

### Шаг 6: Участники и ограничения
```
Требования:

Уровень участников:
  Мин: [2.0 ▼]  Макс: [4.0 ▼]

Пол: ○ Любой ○ Мужской ○ Женский

Возраст: от [14] до [70]

Макс. участников: [___]

Лист ожидания: ☑ Разрешить

Открытость:
○ Для всех на платформе
○ Только мои сообщества
○ Только по приглашению

Привязка к сообществу:
┌──────────────────────────────────┐
│ Без привязки / выбрать из моих   │
└──────────────────────────────────┘
```

### Шаг 7: Стоимость
```
Стоимость участия:

○ Бесплатно
○ Указать стоимость

  Цена: [___] ₸ за участника

  Включает:
  ☑ Аренда корта
  ☐ Мячи
  ☐ Другое: [___]

Дедлайн оплаты:
○ При записи
○ До начала ивента
○ На месте (офлайн)
```

### Шаг 8: Предпросмотр и публикация
- Показ всех введённых данных
- Возможность вернуться и отредактировать любой шаг
- Кнопка «Опубликовать»

---

## Детальный экран ивента

```
┌─────────────────────────────────────────┐
│  ←  Ивент                    ⋮  📤     │
├─────────────────────────────────────────┤
│                                         │
│  🏆 Весенний турнир NTC                 │
│  Round-Robin → Knock-out               │
│                                         │
│  ── Информация ──                      │
│  📅 15 марта, 10:00 – 18:00           │
│  📍 NTC Astana, корты 1-4             │
│  🎾 Singles, Best of 3                 │
│  📊 Уровень: 3.5 – 5.0               │
│  💰 5,000 ₸                           │
│  👤 Организатор: NTC Astana League ✓  │
│                                         │
│  ── Участники (12/16) ──              │
│  [Аватар] Айдар С. (3.5)  ✓          │
│  [Аватар] Марат К. (4.0)  ✓          │
│  [Аватар] Дамир Н. (3.5)  ✓          │
│  ... ещё 9                             │
│  [4 свободных места]                   │
│                                         │
│  ── Описание ──                        │
│  Правила: стандартные ITF...           │
│                                         │
│  ── Турнирная сетка ──                 │
│  [Визуальная сетка / таблица]          │
│                                         │
│  ── Чат ивента ──                      │
│  [Последние 3 сообщения]              │
│  Перейти в чат →                       │
│                                         │
│  ┌────────────────────────────────┐     │
│  │      Записаться (5,000 ₸)     │     │
│  └────────────────────────────────┘     │
└─────────────────────────────────────────┘
```

### Действия на экране ивента

**Для участника:**
- Записаться / Отменить запись
- Оплатить (если платный)
- Перейти в чат ивента
- Поделиться (deeplink)

**Для организатора:**
- Редактировать ивент
- Управлять участниками (принять/отклонить заявку)
- Ввести результаты
- Отменить ивент
- Управлять турнирной сеткой

---

## Ввод результатов матча

После завершения ивента оба участника получают push-уведомление «Подтвердите результат».

### Экран ввода счёта
```
┌──────────────────────────────────┐
│  ←  Результат матча             │
├──────────────────────────────────┤
│                                  │
│  Айдар С.    vs    Марат К.     │
│   (3.5)             (4.0)       │
│                                  │
│  Сет 1:  [ 6 ]  :  [ 4 ]       │
│  Сет 2:  [ 3 ]  :  [ 6 ]       │
│  Сет 3:  [ 7 ]  :  [ 5 ]       │
│                                  │
│  + Добавить тай-брейк           │
│  + Добавить сет                  │
│                                  │
│  Победитель: ○ Айдар ○ Марат    │
│  (автоматически, но можно       │
│   переопределить)                │
│                                  │
│  ┌──────────────────────────┐    │
│  │     Отправить            │    │
│  └──────────────────────────┘    │
└──────────────────────────────────┘
```

### Двухстороннее подтверждение
1. Игрок A вносит счёт
2. Игрок B получает push: «Марат внёс результат: 6:4, 3:6, 7:5. Подтвердите»
3. Игрок B подтверждает или оспаривает
4. При оспаривании → уведомление админу сообщества (если ивент привязан) или обоим игрокам для обсуждения в чате
5. Результат засчитывается только после подтверждения обеих сторон
6. Авто-пересчёт рейтинга после подтверждения

---

## Жизненный цикл ивента

```
Черновик → Опубликован → Набор открыт → Набор закрыт → В процессе → Завершён
                                                                      ↓
                                                              Результаты внесены
                                                                      ↓
                                                              Рейтинг пересчитан
```

**Автоматические переходы:**
- Набор открыт → Набор закрыт: когда все места заняты
- Набор открыт → Набор закрыт: за N минут до начала (настраиваемо)
- В процессе → Завершён: по времени окончания
- Завершён + нет результатов через 48ч → напоминание
- Опубликован + дата прошла → автоматическое завершение (cron job)
