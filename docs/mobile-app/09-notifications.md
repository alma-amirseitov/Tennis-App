# Уведомления 🔔

## Описание
Push-уведомления через Firebase FCM + in-app уведомления через экран колокольчика в хедере.

## Типы уведомлений

| Тип | Push | In-app | Триггер | Deeplink |
|-----|------|--------|---------|----------|
| Отклик на запрос | ✓ | ✓ | Кто-то записался на мой ивент | → Детальный экран ивента |
| Напоминание 24ч | ✓ | ✓ | За 24 часа до игры | → Детальный экран ивента |
| Напоминание 1ч | ✓ | ✓ | За 1 час до игры | → Детальный экран ивента |
| Подтвердить счёт | ✓ | ✓ | Соперник внёс результат | → Экран подтверждения счёта |
| Новость сообщества | ✓ | ✓ | Админ опубликовал пост | → Пост |
| Новое сообщение | ✓ | ✓ | Личное сообщение в чате | → Чат |
| Изменение рейтинга | ✓ | ✓ | Рейтинг пересчитан | → Профиль → рейтинг |
| Новый бейдж | ✓ | ✓ | Получено достижение | → Профиль → достижения |
| Заявка в сообщество | ✓ | ✓ | Кто-то хочет вступить (для админа) | → Управление участниками |
| Заявка одобрена | ✓ | ✓ | Моя заявка в сообщество принята | → Страница сообщества |
| Ивент отменён | ✓ | ✓ | Организатор отменил ивент | → Экран ивента |
| Место освободилось | ✓ | ✓ | Из листа ожидания → участник | → Детальный экран ивента |

## Экран уведомлений

```
┌─────────────────────────────────────────┐
│  ←  Уведомления                        │
├─────────────────────────────────────────┤
│                                         │
│  ── Сегодня ──                         │
│  ┌─────────────────────────────────┐    │
│  │ 🎾 Марат К. записался на вашу  │ ●  │
│  │ игру «Singles завтра 18:00»     │    │
│  │                        10 мин   │    │
│  └─────────────────────────────────┘    │
│  ┌─────────────────────────────────┐    │
│  │ 📊 Ваш рейтинг вырос: 1,345   │ ●  │
│  │ (+45 после победы)              │    │
│  │                        2 часа   │    │
│  └─────────────────────────────────┘    │
│                                         │
│  ── Вчера ──                           │
│  ┌─────────────────────────────────┐    │
│  │ 🏆 Подтвердите результат:      │    │
│  │ Марат vs Айдар 6:4 3:6 7:5     │    │
│  │ [Подтвердить] [Оспорить]       │    │
│  │                        19:30    │    │
│  └─────────────────────────────────┘    │
│  ┌─────────────────────────────────┐    │
│  │ 🏛 Tennis Club: Тренировка в   │    │
│  │ субботу отменяется из-за погоды │    │
│  │                        14:00    │    │
│  └─────────────────────────────────┘    │
│                                         │
│  ── Ранее ──                           │
│  ...                                    │
└─────────────────────────────────────────┘
```

## Push-уведомления

### Формат push
```
Title: [Категория]
Body: [Описание события]
Data: { type, deeplink, entity_id }
```

### Примеры:
```
Title: Новый участник
Body: Марат К. записался на вашу игру «Singles 15 фев 18:00»
---
Title: Напоминание
Body: Игра через 1 час! Singles на NTC Astana, корт 3
---
Title: Подтвердите счёт
Body: Марат К. внёс результат: 6:4, 3:6, 7:5. Подтвердите
---
Title: 🏅 Новое достижение!
Body: Вы получили бейдж «10 побед»!
---
Title: Рейтинг обновлён
Body: Ваш рейтинг: 1,345 (▲ +45)
```

### Настройки push (гранулярные)
Пользователь может отключить каждый тип отдельно в Настройках → Уведомления.

### Тихие часы
- По умолчанию: 23:00 – 07:00
- Настраиваемо пользователем
- Push копятся и приходят после окончания тихих часов
- Исключение: напоминание за 1 час (всегда приходит)

## Badge Counter
- Число в хедере на 🔔 = количество непрочитанных уведомлений
- Число в хедере на 💬 = количество непрочитанных чатов
- Число на иконке приложения = сумма обоих

## Технические детали
- **Firebase FCM** для push
- **Серверная логика**: Go backend генерирует уведомления при событиях
- **In-app**: REST API для получения списка уведомлений (пагинация)
- **Read status**: отмечается при открытии экрана уведомлений
- **Retention**: уведомления хранятся 90 дней
